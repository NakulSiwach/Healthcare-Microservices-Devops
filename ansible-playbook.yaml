---
- name: Apply Kubernetes manifests from the Kubernetes folder
  hosts: localhost
  become: false
  tasks:
    - name: Apply pvc
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/pvc.yml

    - name: Apply mysql config
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/mysql-config.yml

    - name: Apply mysql
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/mysql.yml

    - name: Apply eureka
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/eureka.yml

    - name: Apply rabbitmq
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/rabbitmq.yml

    - name: Apply patient service
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/patient.yml

    - name: Apply doctor service
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/doctor.yml

    - name: Apply appointment service
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/appointment.yml

    - name: Apply notification service
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/notification.yml

    - name: Apply gateway
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/gateway.yml

    - name: Apply ingress
      environment:
        KUBECONFIG: /home/administrator/.kube/config
      command: kubectl apply -f {{ playbook_dir }}/Kubernetes/healthcare-ingress.yaml
